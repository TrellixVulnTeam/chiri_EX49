"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const schematics_1 = require("@angular-devkit/schematics");
const workspace_1 = require("@nrwl/workspace");
const literals_1 = require("@angular-devkit/core/src/utils/literals");
const migration_utils_1 = require("../utils/migration-utils");
const devkit_1 = require("@nrwl/devkit");
function displayInformation() {
    devkit_1.logger.info(literals_1.stripIndents `
    The configPath is mandatory now. If your configPath doesn't match <projectRoot>/stencil.config.ts please update
    your project builder in workspace.json/angular.json accordingly!
  `);
}
function isConfigPathSet(project, builder) {
    return typeof project.architect[builder].options.configPath == 'string';
}
function updateBuilderConfigPath(workspaceJson) {
    Object.keys(workspaceJson.projects).map((k) => {
        const project = workspaceJson.projects[k];
        ['build', 'test', 'e2e'].forEach((builderCommand) => {
            if (migration_utils_1.isStencilProjectBuilder(project, builderCommand) &&
                !isConfigPathSet(project, builderCommand)) {
                project.architect[builderCommand].options.configPath = `${project.root}/stencil.config.ts`;
            }
        });
    });
    return workspaceJson;
}
function update() {
    return schematics_1.chain([
        displayInformation,
        workspace_1.updateWorkspaceInTree(updateBuilderConfigPath),
        workspace_1.formatFiles(),
    ]);
}
exports.default = update;
//# sourceMappingURL=update-0-0-14.js.map